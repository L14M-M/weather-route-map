<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Brian's Route Weather Map</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link href='https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.css' rel='stylesheet' />
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <div class="sidebar-header" onclick="toggleDrawer()">
                <div class="drag-handle"></div>
                <h1>üó∫Ô∏è Brian's Route Weather Map</h1>
            </div>
            <div class="sidebar-content">
                <!-- Desktop view: normal layout -->
                <div class="desktop-sidebar-content">
                    <p class="subtitle">Plan your journey with weather insights</p>
                
                    <form id="routeForm">
                    <div class="input-group">
                        <label for="startLocation">Starting Location</label>
                        <div class="input-wrapper">
                            <input type="text" id="startLocation" placeholder="e.g., Stevensville, MD" required autocomplete="off">
                            <button type="button" class="clear-input" onclick="clearInput('startLocation')">√ó</button>
                        </div>
                        <div id="startSuggestions" class="autocomplete-suggestions"></div>
                    </div>
                    
                    <div class="input-group">
                        <label for="endLocation">Destination</label>
                        <div class="input-wrapper">
                            <input type="text" id="endLocation" placeholder="e.g., Annapolis, MD" required autocomplete="off">
                            <button type="button" class="clear-input" onclick="clearInput('endLocation')">√ó</button>
                        </div>
                        <div id="endSuggestions" class="autocomplete-suggestions"></div>
                    </div>
                    
                    <div class="input-group">
                        <label for="departureTime">Departure Time</label>
                        <input type="datetime-local" id="departureTime" required>
                    </div>
                    
                    <button type="submit" id="submitBtn">Get Route & Weather</button>
                </form>
                
                    <div id="loading" class="loading hidden">
                        <div class="spinner"></div>
                        <p>Calculating route and weather...</p>
                    </div>
                    
                    <div id="error" class="error hidden"></div>
                    
                    <div id="routeInfo" class="route-info hidden">
                        <h3 class="collapsible-header" onclick="toggleSection('routeInfoContent')">
                            Details
                            <span class="toggle-icon">‚ñº</span>
                        </h3>
                        <div id="routeInfoContent" class="collapsible-content">
                            <div class="info-item">
                                <strong>Distance:</strong> <span id="distance"></span>
                            </div>
                            <div class="info-item">
                                <strong>Duration:</strong> <span id="duration"></span>
                            </div>
                            <button id="weatherSummaryBtn" class="weather-summary-btn" onclick="toggleWeatherModal()">
                                View Weather Summary
                            </button>
                        </div>
                    </div>
                    
                    <div id="navigateSection" class="navigate-section hidden">
                        <button class="navigate-toggle-btn" onclick="toggleNavigateMenu()">
                            üìç Open Route In...
                        </button>
                        <div id="navigateMenu" class="navigate-menu hidden">
                            <button onclick="openInAppleMaps()" class="navigate-option">
                                üó∫Ô∏è Apple Maps
                            </button>
                            <button onclick="openInWaze()" class="navigate-option">
                                üìç Waze
                            </button>
                            <button onclick="openInGoogleMaps()" class="navigate-option">
                                üåê Google Maps
                            </button>
                        </div>
                    </div>
                    
                    <!-- Desktop Save Route button -->
                    <button id="saveRouteBtn" class="save-route-btn desktop-only hidden" onclick="saveCurrentRoute()">
                        ‚≠ê Save Route
                    </button>
                </div>
                
                <!-- Desktop Clear Route button at bottom -->
                <button id="clearRouteBtn" class="clear-route-btn desktop-only hidden" onclick="clearRoute()">
                    Clear Route
                </button>
                
                <!-- Mobile carousel -->
                <div class="mobile-carousel-wrapper">
                    <div class="mobile-carousel-container">
                        <!-- Slide 1: Inputs -->
                        <div class="mobile-carousel-slide">
                            <form id="routeFormMobile">
                            <div class="input-group">
                                <label for="startLocationMobile">Starting Location</label>
                                <div class="input-wrapper">
                                    <input type="text" id="startLocationMobile" placeholder="e.g., Stevensville, MD" required autocomplete="off">
                                    <button type="button" class="clear-input" onclick="clearInput('startLocationMobile')">√ó</button>
                                </div>
                                <div id="startSuggestionsMobile" class="autocomplete-suggestions"></div>
                            </div>
                            
                            <div class="input-group">
                                <label for="endLocationMobile">Destination</label>
                                <div class="input-wrapper">
                                    <input type="text" id="endLocationMobile" placeholder="e.g., Annapolis, MD" required autocomplete="off">
                                    <button type="button" class="clear-input" onclick="clearInput('endLocationMobile')">√ó</button>
                                </div>
                                <div id="endSuggestionsMobile" class="autocomplete-suggestions"></div>
                            </div>
                            
                            <div class="input-group">
                                <label for="departureTimeMobile">Departure Time</label>
                                <input type="datetime-local" id="departureTimeMobile" required>
                            </div>
                            
                            <button type="submit" id="submitBtnMobile">Get Route & Weather</button>
                        </form>
                        
                            <div id="loadingMobile" class="loading hidden">
                                <div class="spinner"></div>
                                <p>Calculating route and weather...</p>
                            </div>
                            
                            <div id="errorMobile" class="error hidden"></div>
                        </div>
                        
                        <!-- Slide 2: Route Details -->
                        <div class="mobile-carousel-slide">
                            <div id="routeInfoMobile" class="route-info hidden">
                                <h3>Details</h3>
                                <div class="info-item">
                                    <strong>Distance:</strong> <span id="distanceMobile"></span>
                                </div>
                                <div class="info-item">
                                    <strong>Duration:</strong> <span id="durationMobile"></span>
                                </div>
                                <button id="weatherSummaryBtnMobile" class="weather-summary-btn" onclick="toggleWeatherModal()">
                                    View Weather Summary
                                </button>
                            </div>
                            
                            <div id="navigateSectionMobile" class="navigate-section hidden">
                                <button class="navigate-toggle-btn" onclick="toggleNavigateMenu()">
                                    üìç Open Route In...
                                </button>
                                <div id="navigateMenuMobile" class="navigate-menu hidden">
                                    <button onclick="openInAppleMaps()" class="navigate-option">
                                        üó∫Ô∏è Apple Maps
                                    </button>
                                    <button onclick="openInWaze()" class="navigate-option">
                                        üìç Waze
                                    </button>
                                    <button onclick="openInGoogleMaps()" class="navigate-option">
                                        üåê Google Maps
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Save Route button -->
                            <button id="saveRouteBtnMobile" class="save-route-btn hidden" onclick="saveCurrentRoute()">
                                ‚≠ê Save Route
                            </button>
                            
                            <div class="mobile-route-placeholder">
                                <p>üìç Enter your route details and calculate to see results here</p>
                            </div>
                            
                            <!-- Clear Route button at bottom of this slide -->
                            <button id="clearRouteBtnMobile" class="clear-route-btn hidden" onclick="clearRoute()">
                                Clear Route
                            </button>
                        </div>
                    </div>
                    <div class="carousel-dots">
                        <span class="carousel-dot active" data-slide="0"></span>
                        <span class="carousel-dot" data-slide="1"></span>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="map" class="map">
            <!-- Hamburger menu button on map -->
            <button id="menuButton" class="menu-button" onclick="toggleMapMenu()">
                <div class="hamburger-icon">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </button>
            
            <!-- Floating menu -->
            <div id="mapMenu" class="map-menu hidden">
                <button class="map-menu-item" onclick="toggleLegendModal(); toggleMapMenu();">
                    <span class="menu-icon">üå¶Ô∏è</span>
                    <span>Conditions Legend</span>
                </button>
                <button class="map-menu-item" onclick="toggleSavedRoutesModal(); toggleMapMenu();">
                    <span class="menu-icon">‚≠ê</span>
                    <span>Saved Routes</span>
                </button>
            </div>
        </div>
        
        <!-- Legend Modal -->
        <div id="legendModal" class="legend-modal hidden">
            <div class="legend-modal-content">
                <div class="legend-modal-header">
                    <h4>Conditions Legend</h4>
                    <button class="close-modal" onclick="toggleLegendModal()">√ó</button>
                </div>
                <div class="legend-modal-body">
                    <div class="legend-item">
                        <span class="color-box" style="background: #4ade80;"></span>
                        <span>Clear/Sunny</span>
                    </div>
                    <div class="legend-item">
                        <span class="color-box" style="background: #86efac;"></span>
                        <span>Cloudy</span>
                    </div>
                    <div class="legend-item">
                        <span class="color-box" style="background: #9ca3af;"></span>
                        <span>Fog</span>
                    </div>
                    <div class="legend-item">
                        <span class="color-box" style="background: #60a5fa;"></span>
                        <span>Drizzle/Light Rain</span>
                    </div>
                    <div class="legend-item">
                        <span class="color-box" style="background: #3b82f6;"></span>
                        <span>Rain</span>
                    </div>
                    <div class="legend-item">
                        <span class="color-box" style="background: #1e40af;"></span>
                        <span>Heavy Rain</span>
                    </div>
                    <div class="legend-item">
                        <span class="color-box" style="background: #e9d5ff;"></span>
                        <span>Light Snow</span>
                    </div>
                    <div class="legend-item">
                        <span class="color-box" style="background: #a855f7;"></span>
                        <span>Snow</span>
                    </div>
                    <div class="legend-item">
                        <span class="color-box" style="background: #9333ea;"></span>
                        <span>Heavy Snow</span>
                    </div>
                    <div class="legend-item">
                        <span class="color-box" style="background: #ef4444;"></span>
                        <span>Thunderstorm</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Weather Summary Modal -->
        <div id="weatherModal" class="legend-modal hidden">
            <div class="legend-modal-content">
                <div class="legend-modal-header">
                    <h4>Weather Summary</h4>
                    <button class="close-modal" onclick="toggleWeatherModal()">√ó</button>
                </div>
                <div class="legend-modal-body" id="weatherModalContent">
                    <!-- Weather summary will be inserted here -->
                </div>
            </div>
        </div>
        
        <!-- Saved Routes Modal -->
        <div id="savedRoutesModal" class="legend-modal hidden">
            <div class="legend-modal-content">
                <div class="legend-modal-header">
                    <h4>Saved Routes</h4>
                    <button class="close-modal" onclick="toggleSavedRoutesModal()">√ó</button>
                </div>
                <div class="legend-modal-body" id="savedRoutesContent">
                    <!-- Saved routes will be inserted here -->
                </div>
            </div>
        </div>
        
        <!-- Input Modal (for route name) -->
        <div id="inputModal" class="legend-modal hidden">
            <div class="legend-modal-content input-modal-content">
                <div class="legend-modal-header">
                    <h4 id="inputModalTitle">Enter Route Name</h4>
                    <button class="close-modal" onclick="closeInputModal()">√ó</button>
                </div>
                <div class="legend-modal-body">
                    <input type="text" id="inputModalField" class="input-modal-field" placeholder="Enter name...">
                    <div class="input-modal-actions">
                        <button class="input-modal-btn cancel-btn" onclick="closeInputModal()">Cancel</button>
                        <button class="input-modal-btn confirm-btn" onclick="confirmInputModal()">Save</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src='https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.js'></script>
    <script src="/app.js"></script>
</body>
</html>